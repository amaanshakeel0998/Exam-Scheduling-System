<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>University Datesheet Generator</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <div class="header-content">
          <div class="header-left">
            <button class="mobile-menu-toggle" id="mobile-menu-toggle">
              <i class="fas fa-bars"></i>
            </button>
            <div class="logo">
              <i class="fas fa-calendar-alt"></i>
              <h1>Automatic Datesheet Generator</h1>
            </div>
          </div>
          <p class="subtitle">Tech & Innovative Society</p>
          <!-- Theme Toggle Button -->
          <div class="header-actions">
            <button class="restore-btn hidden" id="restore-session-btn">
              <i class="fas fa-undo"></i> <span>Restore Session</span>
            </button>
            <button class="theme-toggle-btn" id="theme-toggle-btn">
              <i class="fas fa-palette"></i> <span>Theme</span>
            </button>
          </div>
        </div>
      </header>

      <!-- Theme Customization Panel -->
      <div class="theme-panel" id="theme-panel">
        <div class="theme-panel-content">
          <div class="theme-panel-header">
            <h3><i class="fas fa-palette"></i> Theme Customization</h3>
            <button class="close-theme-btn" id="close-theme-btn">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="theme-panel-body">
            <div class="color-picker-group">
              <div class="color-picker-item">
                <label for="header-color">
                  <i class="fas fa-paint-brush"></i> Header Color
                </label>
                <div class="color-input-group">
                  <input type="color" id="header-color" value="#4a90e2" />
                  <input
                    type="text"
                    id="header-color-text"
                    value="#4a90e2"
                    readonly
                  />
                </div>
              </div>
              <div class="color-picker-item">
                <label for="body-color">
                  <i class="fas fa-fill-drip"></i> Body/Section Color
                </label>
                <div class="color-input-group">
                  <input type="color" id="body-color" value="#f5f7fa" />
                  <input
                    type="text"
                    id="body-color-text"
                    value="#f5f7fa"
                    readonly
                  />
                </div>
              </div>
              <div class="color-picker-item">
                <label for="card-color">
                  <i class="fas fa-square"></i> Card Background
                </label>
                <div class="color-input-group">
                  <input type="color" id="card-color" value="#ffffff" />
                  <input
                    type="text"
                    id="card-color-text"
                    value="#ffffff"
                    readonly
                  />
                </div>
              </div>
              <div class="color-picker-item">
                <label for="accent-color">
                  <i class="fas fa-star"></i> Accent Color
                </label>
                <div class="color-input-group">
                  <input type="color" id="accent-color" value="#4a90e2" />
                  <input
                    type="text"
                    id="accent-color-text"
                    value="#4a90e2"
                    readonly
                  />
                </div>
              </div>
            </div>

            <div class="theme-presets">
              <h4><i class="fas fa-swatchbook"></i> Quick Presets</h4>
              <div class="preset-buttons">
                <button class="preset-btn" data-preset="default">
                  <span
                    class="preset-color"
                    style="
                      background: linear-gradient(135deg, #4a90e2, #357abd);
                    "
                  ></span>
                  Default Blue
                </button>
                <button class="preset-btn" data-preset="purple">
                  <span
                    class="preset-color"
                    style="
                      background: linear-gradient(135deg, #667eea, #764ba2);
                    "
                  ></span>
                  Purple
                </button>
                <button class="preset-btn" data-preset="green">
                  <span
                    class="preset-color"
                    style="
                      background: linear-gradient(135deg, #56ab2f, #a8e063);
                    "
                  ></span>
                  Green
                </button>
                <button class="preset-btn" data-preset="orange">
                  <span
                    class="preset-color"
                    style="
                      background: linear-gradient(135deg, #f46b45, #eea849);
                    "
                  ></span>
                  Orange
                </button>
                <button class="preset-btn" data-preset="red">
                  <span
                    class="preset-color"
                    style="
                      background: linear-gradient(135deg, #eb3349, #f45c43);
                    "
                  ></span>
                  Red
                </button>
                <button class="preset-btn" data-preset="dark">
                  <span
                    class="preset-color"
                    style="
                      background: linear-gradient(135deg, #2c3e50, #34495e);
                    "
                  ></span>
                  Dark
                </button>
              </div>
            </div>

            <div class="theme-actions">
              <button class="btn btn-secondary" id="reset-theme-btn" style="flex: 1;">
                <i class="fas fa-undo"></i> Reset to Default
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Sidebar -->
        <aside class="sidebar">
          <nav class="nav-menu">
            <button class="nav-item active" data-section="input">
              <i class="fas fa-keyboard"></i>
              <span>Data Input</span>
            </button>
            <button class="nav-item" data-section="datesheet">
              <i class="fas fa-calendar-check"></i>
              <span>View Datesheet</span>
            </button>
            <button class="nav-item" data-section="conflicts">
              <i class="fas fa-exclamation-triangle"></i>
              <span>Status & Conflicts</span>
            </button>
          </nav>
        </aside>

        <!-- Content Area -->
        <main class="content">
          <!-- Input Section -->
          <section id="input-section" class="section active">
            <h2 class="section-title">
              <i class="fas fa-database"></i>
              Input Data
            </h2>

            <!-- Exam Configuration (Date Range & Times) -->
            <div class="card">
              <h3 class="card-title">
                <i class="fas fa-clock"></i> Exam Configuration
              </h3>
              <div class="form-group">
                <label>Date Range</label>
                <div class="input-group">
                  <div class="date-input-col">
                    <label for="start-date" class="label-small"
                      >Start Date</label
                    >
                    <input type="date" id="start-date" />
                  </div>
                  <div class="date-input-col">
                    <label for="end-date" class="label-small">End Date</label>
                    <input type="date" id="end-date" />
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label>Daily Exam Slots</label>
                <div id="time-slots-container">
                  <div class="input-tag-group"></div>
                </div>
                <div class="input-group">
                  <div
                    class="searchable-select"
                    id="timeslot-select"
                    style="flex: 1"
                  >
                    <select id="new-timeslot">
                      <option value="">Select Time Slot</option>
                      <option value="08:30 - 11:30">08:30 - 11:30</option>
                      <option value="09:00 - 12:00">09:00 - 12:00</option>
                      <option value="01:00 - 04:00">01:00 - 04:00</option>
                      <option value="14:00 - 17:00">02:00 - 05:00</option>
                    </select>
                  </div>
                  <button class="btn btn-secondary" id="add-timeslot-btn">
                    <i class="fas fa-plus"></i> Add
                  </button>
                </div>
              </div>
            </div>

            <!-- Departments -->
            <div class="card">
              <h3 class="card-title">
                <i class="fas fa-building"></i> Departments & Semesters
              </h3>
              <!-- First Row: Semester Setting -->
              <div class="form-row">
                <div class="form-group" style="flex: 1">
                  <label for="total-semesters">Total Semesters</label>
                  <div class="input-group">
                    <input type="number" id="total-semesters" placeholder="e.g., 8" min="1" value="3"/>
                    <button class="btn btn-primary" id="apply-semesters-btn">
                      <i class="fas fa-check"></i> Apply
                    </button>
                  </div>
                </div>
              </div>
              <!-- Second Row: Department Selection (Initially Hidden or separated) -->
              <div class="form-row hidden" id="dept-input-row">
                <div class="form-group" style="flex: 1">
                  <label>Add Department</label>
                  <div class="input-group">
                    <div class="searchable-select" style="flex: 1">
                      <select id="dept-input">
                        <option value="">Select Department</option>
                        <option value="CS – Computer Science">CS – Computer Science</option>
                        <option value="SE – Software Engineering">SE – Software Engineering</option>
                        <option value="BBA – Business Administration">BBA – Business Administration</option>
                        <option value="PSY – Psychology">PSY – Psychology</option>
                        <option value="AF – Accounting & Finance">AF – Accounting & Finance</option>
                        <option value="ID – Interior Design">ID – Interior Design</option>
                        <option value="ELS – English & Linguistic Studies">ELS – English & Linguistic Studies</option>
                        <option value="DDCA – Digital Design & Computer Arts">DDCA – Digital Design & Computer Arts</option>
                      </select>
                    </div>
                    <button class="btn btn-secondary" id="add-dept-btn">
                      <i class="fas fa-plus"></i> Add
                    </button>
                  </div>
                </div>
              </div>
              <div id="dept-list" class="items-list"></div>
            </div>

            <!-- Exams / Subjects -->
            <div class="card">
              <h3 class="card-title">
                <i class="fas fa-book"></i> Exams & Courses
              </h3>
              <div id="exams-list" class="items-list"></div>

              <div class="form-row">
                <div class="form-group" style="flex: 1">
                  <label for="course-semester">Semester</label>
                  <select id="course-semester">
                    <option value="3">Select Semester</option>
                  </select>
                </div>
                <div class="form-group" style="flex: 2">
                  <label>Departments</label>
                  <div class="input-group">
                    <div class="searchable-select" style="flex: 1">
                      <select id="course-dept-select" disabled>
                        <option value="">Select Dept</option>
                      </select>
                    </div>
                    <button
                      class="btn btn-sm btn-secondary"
                      id="add-exam-dept-btn"
                    >
                      Add
                    </button>
                  </div>
                  <div
                    id="exam-depts-list"
                    class="input-tag-group"
                    style="margin-top: 0.5rem"
                  ></div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group" style="flex: 2">
                  <label>Course Name</label>
                  <div class="searchable-select">
                    <select id="course-name" disabled>
                      <option value="">Select Course Name</option>
                    </select>
                  </div>
                </div>
                <div class="form-group" style="flex: 1">
                  <label>Course Code</label>
                  <div class="searchable-select">
                    <select id="course-code">
                      <option value="">Select Code</option>
                    </select>
                  </div>
                </div>
              </div>

              <button
                class="btn btn-secondary"
                id="add-exam-btn"
                style="width: 100%; margin-top: 0.5rem"
              >
                <i class="fas fa-plus"></i> Add Exam
              </button>
            </div>

            <!-- Invigilators -->
            <div class="card">
              <h3 class="card-title">
                <i class="fas fa-user-tie"></i> Invigilators
              </h3>
              <div id="invigilators-list" class="items-list"></div>

              <div class="form-row">
                <div class="form-group" style="flex: 2">
                  <label>Name</label>
                  <div class="searchable-select">
                    <select id="invigilator-name">
                      <option value="">Select Invigilator</option>
                      <option value="Dr. Amad Ud Din">Dr. Amad Ud Din</option>
                      <option value="Dr. Abdul Waheed">Dr. Abdul Waheed</option>
                      <option value="Mr. Muhammad Adil">Mr. Muhammad Adil</option>
                      <option value="Ms. Khadija Waheed">Ms. Khadija Waheed</option>
                      <option value="Ms. Aina Merzia">Ms. Aina Merzia</option>
                      <option value="Dr. Rubab Tahir">Dr. Rubab Tahir</option>
                      <option value="Ms. Amna Malik">Ms. Amna Malik</option>
                      <option value="Ms. Farah Nazeer">Ms. Farah Nazeer</option>
                      <option value="Mr. Muhammad Faran">Mr. Muhammad Faran</option>
                      <option value="Dr. Aisha Parveen">Dr. Aisha Parveen</option>
                      <option value="Dr. Aziz Haider">Dr. Aziz Haider</option>
                      <option value="Dr. Muhammad Bilal">Dr. Muhammad Bilal</option>
                      <option value="Dr. Saniya Moazzam">Dr. Saniya Moazzam</option>
                      <option value="Dr. Samiya Bashir">Dr. Samiya Bashir</option>
                      <option value="Mr. Imran Ejaz">Mr. Imran Ejaz</option>
                      <option value="Dr. Salman Chugtai">Dr. Salman Chugtai</option>
                      <option value="Ms. Esha Gul">Ms. Esha Gul</option>
                    </select>
                  </div>
                </div>
                <div class="form-group" style="flex: 1">
                  <label>Max Duties</label>
                  <input
                    type="number"
                    id="max-duties"
                    placeholder="e.g., 5"
                    value="5"
                    min="1"
                  />
                </div>
              </div>

              <div class="form-group">
                <label>Available Dates (Optional)</label>
                <div class="input-group">
                  <input type="date" id="invigilator-available-date" />
                  <button
                    class="btn btn-sm btn-secondary"
                    id="add-available-date"
                  >
                    Add Date
                  </button>
                </div>
                <div
                  id="available-dates-list"
                  class="input-tag-group"
                  style="margin-top: 0.5rem"
                ></div>
              </div>

              <button
                class="btn btn-secondary"
                id="add-invigilator-btn"
                style="width: 100%; margin-top: 0.5rem"
              >
                <i class="fas fa-plus"></i> Add Invigilator
              </button>
            </div>

            <!-- Rooms -->
            <div class="card">
              <h3 class="card-title"><i class="fas fa-door-open"></i> Rooms</h3>
              <div id="rooms-list" class="items-list"></div>

              <div class="form-row">
                <div class="form-group" style="flex: 1">
                  <label>Room Name/Number</label>
                  <input
                    type="text"
                    id="room-name"
                    placeholder="e.g., Room 101"
                  />
                </div>
              </div>

              <button
                class="btn btn-secondary"
                id="add-room-btn"
                style="width: 100%; margin-top: 0.5rem"
              >
                <i class="fas fa-plus"></i> Add Room
              </button>
            </div>

            <!-- Generate Button -->
            <div class="action-bar">
              <button class="btn btn-primary btn-large" id="generate-btn" onclick="console.log('Generate clicked via onclick'); generateDatesheet()">
                <i class="fas fa-magic"></i> Generate Datesheet
              </button>
            </div>
          </section>

          <!-- Datesheet View Section -->
          <section id="datesheet-section" class="section">
            <h2 class="section-title">
              <i class="fas fa-calendar-check"></i>
              Generated Datesheet
            </h2>

            <div class="action-bar justify-end" style="margin-bottom: 20px">
              <button class="btn btn-secondary" id="export-pdf-btn">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
              <button class="btn btn-secondary" id="export-csv-btn">
                <i class="fas fa-file-csv"></i> CSV
              </button>
              <button class="btn btn-primary" id="regenerate-btn">
                <i class="fas fa-sync"></i> Regenerate
              </button>
              <div class="import-wrapper">
                <input type="file" id="csv-import-input" accept=".csv, .xlsx, .xls" style="display: none;" />
                <button class="btn btn-secondary" id="import-csv-btn">
                  <i class="fas fa-file-import"></i> Import CSV/Excel
                </button>
              </div>
            </div>

            <div id="datesheet-container">
              <!-- Datesheet table will be rendered here -->
              <div class="empty-state">
                <i
                  class="fas fa-calendar-times"
                  style="
                    font-size: 3rem;
                    color: var(--text-light);
                    margin-bottom: 1rem;
                  "
                ></i>
                <p>No datesheet generated yet.</p>
              </div>
            </div>
          </section>

          <!-- Conflicts Section -->
          <section id="conflicts-section" class="section">
            <h2 class="section-title">
              <i class="fas fa-exclamation-triangle"></i>
              Status & Conflicts
            </h2>
            <div id="conflicts-list">
              <div class="empty-state">
                <i
                  class="fas fa-check-circle"
                  style="
                    font-size: 3rem;
                    color: var(--success-color);
                    margin-bottom: 1rem;
                  "
                ></i>
                <p>No conflicts detected.</p>
              </div>
            </div>
          </section>
        </main>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-question-circle"></i> Confirmation</h3>
          <button class="close-modal-btn" id="close-modal-btn">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <p id="confirmation-message">Are you sure you want to proceed?</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" id="cancel-confirm-btn">
            Cancel
          </button>
          <button class="btn btn-primary" id="confirm-action-btn">
            Confirm
          </button>
        </div>
      </div>
    </div>

    <!-- PDF Configuration Modal -->
    <div id="pdf-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-file-pdf"></i> PDF Export Configuration</h3>
          <button class="close-modal-btn" id="close-pdf-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="pdf-institute-name">Institute Name</label>
            <input type="text" id="pdf-institute-name" placeholder="e.g., University of Technology" />
          </div>
          <div class="form-group">
            <label for="pdf-logo">Institute Logo</label>
            <input type="file" id="pdf-logo" accept="image/*" />
          </div>
          <div class="form-group">
            <label for="pdf-exam-title">Exam Title</label>
            <input type="text" id="pdf-exam-title" placeholder="e.g., Final Exams Fall 2025" />
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" id="cancel-pdf-btn">Cancel</button>
          <button class="btn btn-primary" id="download-pdf-btn">Download PDF</button>
        </div>
      </div>
    </div>

    <!-- Edit Exam Modal -->
    <div id="edit-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-edit"></i> Edit Scheduled Exam</h3>
          <button class="close-modal-btn" id="close-edit-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="edit-semester">Semester</label>
            <div class="searchable-select">
              <select id="edit-semester"></select>
            </div>
          </div>
          <div class="form-group">
            <label for="edit-course-code">Course Code</label>
            <input type="text" id="edit-course-code" />
          </div>
          <div class="form-group">
            <label for="edit-course-name">Course Name</label>
            <input type="text" id="edit-course-name" />
          </div>
          <div class="form-group">
            <label>Departments (Comma separated)</label>
            <input type="text" id="edit-depts" />
          </div>
          <div class="form-group">
            <label for="edit-room">Room</label>
            <div class="searchable-select">
              <select id="edit-room"></select>
            </div>
          </div>
          <div class="form-group">
            <label for="edit-invigilator">Invigilator</label>
            <div class="searchable-select">
              <select id="edit-invigilator"></select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" id="cancel-edit-btn">Cancel</button>
          <button class="btn btn-primary" id="save-edit-btn">Save Changes</button>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="script.js"></script>

    <!-- Issue Reporting Feature -->
    <div id="issue-report-trigger" title="Report an Issue">
      <i class="fas fa-exclamation-circle"></i>
    </div>

    <div id="issue-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3><i class="fas fa-bug"></i> Report an Issue</h3>
          <button class="close-modal-btn" id="close-issue-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <form id="issue-form">
          <div class="modal-body">
            <div class="form-group">
              <label for="issue-name">Name</label>
              <input type="text" id="issue-name" required placeholder="Your Name" />
            </div>
            <div class="form-group">
              <label for="issue-email">Email</label>
              <input type="email" id="issue-email" required placeholder="Your Email" />
            </div>
            <div class="form-group">
              <label for="issue-description">Issue Description</label>
              <textarea id="issue-description" required placeholder="Describe the issue you're facing..." rows="4"></textarea>
            </div>
            <div id="issue-status-message"></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="cancel-issue-btn">Cancel</button>
            <button type="submit" class="btn btn-primary" id="submit-issue-btn">Submit Issue</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Thank You Toast -->
    <div id="thank-you-toast" class="toast">
        <div class="toast-content">
            <i class="fas fa-check-circle"></i>
            <div class="toast-message">
                <h4>Thank You!</h4>
                <p>Your issue has been submitted successfully.</p>
            </div>
        </div>
    </div>
  </body>
</html>
